{% extends "base.html" %}

{% block title %}Available Shows{% endblock %}

{% block content %}
<div class="shows-container">

    <h2><span class="show-label-icon"></span>Available TV Shows</h2>

    <div class="filters-container">

        <div class="sort-options">
            Sort by:
            <a href="{{ url_for('list_shows', sort='name', genre=filter_genre, year=filter_year, rating=filter_rating) }}" {% if sort_by == 'name' %}class="active-sort"{% endif %}>Name</a> |
            <a href="{{ url_for('list_shows', sort='popularity', genre=filter_genre, year=filter_year, rating=filter_rating) }}" {% if sort_by == 'popularity' %}class="active-sort"{% endif %}>Popularity</a> |
            <a href="{{ url_for('list_shows', sort='year', genre=filter_genre, year=filter_year, rating=filter_rating) }}" {% if sort_by == 'year' %}class="active-sort"{% endif %}>Year</a> |
            <a href="{{ url_for('list_shows', sort='rating', genre=filter_genre, year=filter_year, rating=filter_rating) }}" {% if sort_by == 'rating' %}class="active-sort"{% endif %}>Rating</a>
        </div>

        <div class="filter-group">
            <label for="genre-filter">Filter By Genre:</label>
            <a href="{{ url_for('list_shows', sort=sort_by, year=filter_year, rating=filter_rating) }}">All</a> |
            <a href="{{ url_for('list_shows', sort=sort_by, genre='Comedy', year=filter_year, rating=filter_rating) }}">Comedy</a> |
            <a href="{{ url_for('list_shows', sort=sort_by, genre='Action', year=filter_year, rating=filter_rating) }}">Action</a> |
            {# Add more genre links as needed #}
            <form action="{{ url_for('list_shows') }}" method="GET" class="filter-form">
                <input type="hidden" name="sort" value="{{ sort_by }}">
                <input type="hidden" name="year" value="{{ filter_year }}">
                <input type="hidden" name="rating" value="{{ filter_rating }}">
                <input type="text" name="genre" id="genre-filter" placeholder="Enter genre" value="{{ filter_genre }}">
                <button type="submit" class="filter-button">Filter</button>
            </form>
        </div>

        <div class="filter-group">
          <label for="year-filter">Filter By Year:</label>
            <a href="{{ url_for('list_shows', sort=sort_by, genre=filter_genre, rating=filter_rating) }}">All</a> |
                {% for year in range(2024, 1999, -1) %}
                <a href="{{ url_for('list_shows', sort=sort_by, genre=filter_genre, year=year, rating=filter_rating) }}">{{ year }}</a> |
            {% endfor %}
            <form action="{{ url_for('list_shows') }}" method="GET" class="filter-form">
                <input type="hidden" name="sort" value="{{ sort_by }}">
                <input type="hidden" name="genre" value="{{ filter_genre }}">
                <input type="hidden" name="rating" value="{{ filter_rating }}">
                <input type="number" name="year" id="year-filter" placeholder="Enter year" value="{{ filter_year }}">
                <button type="submit" class="filter-button">Filter</button>
            </form>
        </div>

        <div class="filter-group">
            <label for="rating-filter">Filter by Rating:</label>
            <a href="{{ url_for('list_shows', sort=sort_by, genre=filter_genre, year=filter_year) }}">All</a> |
            <a href="{{ url_for('list_shows', sort=sort_by, genre=filter_genre, year=filter_year, rating=7) }}">7+</a> |
            <a href="{{ url_for('list_shows', sort=sort_by, genre=filter_genre, year=filter_year, rating=8) }}">8+</a> |
            <a href="{{ url_for('list_shows', sort=sort_by, genre=filter_genre, year=filter_year, rating=9) }}">9+</a>
            <form action="{{ url_for('list_shows') }}" method="GET" class="filter-form">
              <input type="hidden" name="sort" value="{{ sort_by }}">
              <input type="hidden" name="genre" value="{{ filter_genre }}">
              <input type="hidden" name="year" value="{{ filter_year }}">
              <input type="number" step="0.1" name="rating" id="rating-filter" placeholder="Enter rating" value="{{ filter_rating }}">
              <button type="submit" class="filter-button">Filter</button>
            </form>
        </div>
    </div>

    <ul class="shows-list">
      {% for show in shows.items %}
        <li class="show-item">
            <a href="{{ url_for('show_details', show_id=show.id) }}" class="show-link">
                {{ show.show_name }}
            </a>
          </li>
      {% endfor %}
    </ul>

    {# Pagination links (using Flask-SQLAlchemy's built-in pagination) #}
    <div class="pagination">
        {% if shows.has_prev %}
            <a href="{{ url_for('list_shows', page=shows.prev_num, sort=sort_by, genre=filter_genre, year=filter_year, rating=filter_rating) }}">&laquo; Previous</a>
        {% endif %}
        <span>Page {{ shows.page }} of {{ shows.pages }}</span>
        {% if shows.has_next %}
            <a href="{{ url_for('list_shows', page=shows.next_num, sort=sort_by, genre=filter_genre, year=filter_year, rating=filter_rating) }}">Next &raquo;</a>
        {% endif %}
    </div>
</div>
{% endblock %}
