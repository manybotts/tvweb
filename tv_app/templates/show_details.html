{% extends 'base.html' %}

{% block title %}{{ show.title }}{% endblock %}

{% block content %}
<div class="show-details-container">

    <div class="show-details-banner">
        <h1>{{ show.title }}</h1>
        {#  Episode title is NOT part of the Show model anymore. Removed. #}
    </div>

    <div class="show-details-content">
        <div class="show-image-container">
            {% if show.image_url %}
                <img src="{{ show.image_url }}" alt="{{ show.title }}" class="show-image" loading="lazy">
            {% else %}
                <div class="telegram-loader"></div>  {#  Consistent placeholder #}
            {% endif %}
        </div>

        <div class="show-info">
            {% if show.overview %}
            <p><strong>Overview:</strong> {{ show.overview }}</p>
            {% endif %}
            <p><strong>Genre:</strong> {{ show.genre if show.genre else 'N/A' }}</p>
            <p><strong>Year:</strong> {{ show.release_year if show.release_year else 'N/A' }}</p>
             <p><strong>Available Seasons:</strong> {{ show.available_seasons if show.available_seasons else 'N/A' }}</p>

            {#  The main show might not have a direct download link.  This is usually per-episode. #}
            {% if show.trailer_url %}
                <p><strong>Trailer:</strong> <a href="{{ show.trailer_url }}" target="_blank">Watch Trailer</a></p>
            {% endif %}
        </div>
    </div>

    {# --- Episode Listing --- #}
    {% if episodes %}
    <h2>Episodes</h2>
    <div class="episodes-list">
        {% for episode in episodes %}
        <div class="episode-item">
            <h3>Season {{ episode.season_number }}, Episode {{ episode.episode_number }}</h3>
            {% if episode.title %}
               <h4> {{ episode.title }}</h4>
            {% endif %}

            {% if episode.overview %}
                <p>{{ episode.overview }}</p>
            {% endif %}

            {% if episode.download_link %}
                <a href="{{ url_for('redirect_to_download', episode_id=episode.id) }}" class="download-button">Download Episode</a>
            {% else %}
                <p>Download link not available for this episode.</p>
            {% endif %}
        </div>
      {% else %}
          <p>No episodes found for this show.</p>
        {% endfor %}
    </div>
    {% endif %}

</div>
{% endblock %}
